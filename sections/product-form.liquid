{% assign selected_product = all_products[section.settings.product_handle] %}

{% if selected_product %}
  {% form 'product', selected_product, class: 'product-form', id: 'ProductForm', aria-busy: 'false' %}
    {% if form.errors %}
      <div class="form-errors" role="alert" aria-live="assertive">
        {{ form.errors | default_errors }}
      </div>
    {% endif %}

    {% if form.posted_successfully? %}
      <p class="form-success" role="status" aria-live="polite">
        {{ 'product.form.success' | t }}
      </p>
    {% endif %}

    <input type="hidden" name="id" value="{{ selected_product.selected_or_first_available_variant.id }}">

    <div class="form-group">
      <label for="Quantity">{{ 'product.form.quantity' | t }}</label>
      <input
        id="Quantity"
        name="quantity"
        type="number"
        value="1"
        min="1"
        {% unless selected_product.selected_or_first_available_variant.available %}
          disabled
        {% endunless %}
      >
    </div>

    <div class="form-group">
      <label for="Reason">{{ 'product.form.reason' | t }}</label>
      <input
        id="Reason"
        name="properties[Reason]"
        type="text"
        placeholder="{{ 'product.form.reason_placeholder' | t }}"
      >
    </div>

    <div class="form-group">
      <label for="PreferredContact">{{ 'product.form.contact' | t }}</label>
      <select id="PreferredContact" name="properties[Preferred contact]">
        <option value="Email">{{ 'product.form.contact_email' | t }}</option>
        <option value="Phone">{{ 'product.form.contact_phone' | t }}</option>
      </select>
    </div>

    <button
      type="submit"
      class="btn"
      {% unless selected_product.selected_or_first_available_variant.available %}
        disabled
      {% endunless %}
    >
      {% if selected_product.selected_or_first_available_variant.available %}
        {{ 'product.form.add_to_cart' | t }}
      {% else %}
        {{ 'product.form.unavailable' | t }}
      {% endif %}
    </button>
  {% endform %}
{% else %}
  <p>Please select a product in the section settings.</p>
{% endif %}

{% schema %}
{
  "name": "Product inquiry form",
  "settings": [
    {
      "type": "product",
      "id": "product_handle",
      "label": "Select product"
    }
  ],
  "presets": [
    {
      "name": "Product inquiry form"
    }
  ]
}
{% endschema %}

{% style %}
  .product-form {
    max-width: 400px;
    margin: 20px auto;
    display: flex;
    flex-direction: column;
    gap: 1rem;
    font-family: inherit;
  }

  .product-form label {
    font-weight: 600;
    display: block;
    margin-bottom: 0.3rem;
  }

  .product-form input,
  .product-form select,
  .product-form textarea {
    width: 100%;
    padding: 0.5rem 0.75rem;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 1rem;
  }

  .product-form button {
    background-color: #000;
    color: #fff;
    border: none;
    border-radius: 4px;
    padding: 0.75rem;
    cursor: pointer;
    font-weight: 600;
    transition: opacity 0.2s ease-in-out;
  }

  .product-form button:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }

  .form-errors {
    background-color: #ffecec;
    color: #c00;
    padding: 0.75rem;
    border-radius: 4px;
  }

  .form-success {
    background-color: #e6f9ec;
    color: #2a7a3b;
    padding: 0.75rem;
    border-radius: 4px;
  }
{% endstyle %}
